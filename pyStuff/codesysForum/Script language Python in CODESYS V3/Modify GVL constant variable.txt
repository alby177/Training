Hi,I would like to know if it is possible to modify a GVL constant variable via a python script?If true how can I achieve this?If false what should I use?In the meantime, is there a list of all available global variables in python like projects, online... ?Regards

Hi dam.dam wrote:I would like to know if it is possible to modify a GVL constant variable via a python script?You have to find the GVL object, which contains the variable(s) you want to change, and then you can either export, edit the XML and re-import the object or you can use the interface IScriptTextDocument to modify the structured text (ST) of the declaration directly.The interface IScriptTextDocument is documented in the CHM of the ScriptEngine, which you can find the OnlineHelp directory in the CODESYS base directory. All object which containt an ST based declaration and/or implementation, support the interface IScriptTextualObjectMarker so you can check for it.BRMartin

_________________Check out the CODESYS store: http://store.codesys.com/CODESYS速 a trademark of 3S-Smart Software Solutions GmbHInspiring Automation Solutions

I tried to do:Code:...gvl = project.find('GVL', True)[0]print(gvl.has_textual_declaration())but it failed as gvl is a ScriptObject.Any hint?Regards

To add more informations if I do:Code:gvl.export_native("my_file", True)I got all the values of GVL but:Code:gvl.get_children(True)returns an empty list.Regards

Hi dam.From your second post in this thread:Code:print(gvl.has_textual_declaration())Please remove the brackets after has_textual_declaration because it is a property and not a method. This property is only to check if the object has an ST based declaration. You get the text with the property text, e.g. gvl.text, and modify it with one of the methods, e.g. gvl.replace(modifiedDeclaration).From your third post:Code:gvl.get_children(True)With get_children(bool) you can only get the children of the object in the project structure. But variables are not children of the GVL object. You can only read or modify the ST based declaration.BRMartin

_________________Check out the CODESYS store: http://store.codesys.com/CODESYS速 a trademark of 3S-Smart Software Solutions GmbHInspiring Automation Solutions

Indeed gvl.has_textual_declaration returns True but I do not have the text property.I am using SoMachine 4.1 so maybe the version of Codesys is too old?Regards

Hi damSorry, my fault.dam wrote:Indeed gvl.has_textual_declaration returns True but I do not have the text property.First you have to get the IScriptTextDocument object through the property textual_declaration (see interface IScriptObjectWithTextualDeclaration ) and than you can use text or replace() on that object.BRMartin

_________________Check out the CODESYS store: http://store.codesys.com/CODESYS速 a trademark of 3S-Smart Software Solutions GmbHInspiring Automation Solutions

Thank you for the information and I confirm that it works with Codesys 3.5.7 but it does not work with SoMachine 4.1dam wrote:Indeed gvl.has_textual_declaration returns True but I do not have the text property.I am using SoMachine 4.1 so maybe the version of Codesys is too old?In fact, I was confused and I tested on Codesys 3.5.7 not on SoMachine 4.1. With SoMachine I do not have has_textual_declaration (it usesScriptEngine v3.5.3). Is it possible to update ScriptEngine to a newer version in SoMachine or use a different API?Regards

Hi, Dam,dam wrote:Thank you for the information and I confirm that it works with Codesys 3.5.7 but it does not work with SoMachine 4.1dam wrote:Indeed gvl.has_textual_declaration returns True but I do not have the text property.I am using SoMachine 4.1 so maybe the version of Codesys is too old?In fact, I was confused and I tested on Codesys 3.5.7 not on SoMachine 4.1. With SoMachine I do not have has_textual_declaration (it usesScriptEngine v3.5.3). Is it possible to update ScriptEngine to a newer version in SoMachine or use a different API?RegardsUpdating the ScriptEngine to a newer version cannot be done by a SoMachine enduser, this must be done by Schneider Electric.As far as I remember, Schneider also added some of their own extensions to the ScriptEngine, but I'm not sure whether that was for SoMachine or SoMachine Motion, and which version. I guess you need to ask the Schneider Support contact...

_________________Check out the CODESYS store: http://store.codesys.com/CODESYS速 a trademark of 3S-Smart Software Solutions GmbH Inspiring Automation Solutions

Ok thank you M.Schaber and M.Keller.Regards

