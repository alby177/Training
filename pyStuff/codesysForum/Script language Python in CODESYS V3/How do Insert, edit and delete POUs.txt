Hello team.I need a script to insert a POU below of Application object. I need too a script to edit a specific POU (MainPrg, for example), i.e., add new variables and modify code of POU. Finally is necessary deletar a specific POU.Thanks.Émerson ButzenSoftware DeveloperUnisinos/Altus

Hi butzen.butzen wrote:I need a script to insert a POU below of Application object.The Scripting API was extended with the necessary features with CODESYS V3.5 SP9. Look for IScriptIecLanguageObjectContainer and IScriptIecLanguageMemberContainer in the Scripting documentation.butzen wrote:I need too a script to edit a specific POU (MainPrg, for example), i.e., add new variables and modify code of POU.We can only edit Structure Text directly. For the graphical languages you have to import the POU from PLCopenXML or our native format. See IScriptTextualObjectMarker, IScriptObjectWithTextualDeclaration, IScriptObjectWithTextualImplementation and IScriptTextDocument for the textual language and the methods import_xml() and import_native() from IScriptObject2 and IScriptProject2 for the import.butzen wrote:Finally is necessary deletar a specific POU.Find the Scripting object, for example with find(), and use the method remove() to delete the object.Here some example:Code:proj = projects.primaryfound = proj.find("Application", True)app = found[0]# Create FBmypou = app.create_pou("MyPou")# Change declaration of the FBimplementation = mypou.textual_declaration.replace("""FUNCTION_BLOCK MyPouVAR_INPUT   iValue : INT;END_VARVAR_OUTPUTEND_VARVAREND_VAR""")# Change implementation of the FBmypou.textual_implementation.replace("""iValue := iValue + 1;""")# Add method to FBdosomething = mypou.create_method("DoSomething", "INT")# Change declaration of the methoddosomething.textual_declaration.replace("""METHOD DoSomething : INTVAR_INPUT   iVal1 : INT;   iVal2 : INT;END_VAR""")# Change implementation of the methoddosomething.textual_implementation.replace("""DoSomething := iVal1 + iVal2;""")# Find the pou and delete itfound = app.find("MyPou")if found and len(found) == 1:   found[0].remove()else:   print("POU 'MyPou' was not found"BRMartin

_________________Check out the CODESYS store: http://store.codesys.com/CODESYS® a trademark of 3S-Smart Software Solutions GmbHInspiring Automation Solutions

