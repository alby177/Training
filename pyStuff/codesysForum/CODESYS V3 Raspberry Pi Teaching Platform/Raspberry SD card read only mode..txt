Is there any tutorial of how we can use Codesys Control on Raspberry with read only SD card?Maybe with use of "ramfs".Can any one tell us witch folders we have to mount as "tmpfs"?Regards

Hallo Isislsis,du kannst einfach Lib SysLibFile verwenden und mit File Open eine Datei im Read modus öffnen. Wenn es die Datei gibt, dann erhältst du ein gültiges Handle zurück. Mit diesem Handle kannst du dann mit der Funktion Read das File lesen.Gesendet von iPhone mit Tapatalk

Hi.Sorry maybe I'm wrong and you have misunderstood. I ask how can work the CodesysControl runtime in a system with read onlysd card.Because we take errors at boot time of Linux where not buildedsome folders that needed from Codesys runtime. Regards

Hi,sorry I'm wrong i misunderstood your questionGesendet von iPhone mit Tapatalk

Hello,I would search the forum on the Raspberry Pi organisation for that,or ask this question there.http://www.raspberrypi.org/forums/Best Regardsplcmax

I need specific information of Codesys runtime needs.The rest of Linux functionality works fine after setup forread only working mode of sd card.The fail messages at boot up coming from Codesys runtime wheretry to build some folders and files I thing at boot up time.Regards

Hi,could you share the information how you set this up as readonly?Could you paste the message where you see that part of the runtime fails... screenshotBREdwin

http://blog.pi3g.com/2014/04/make-raspbian-system-read-only/http://nutcom.hu/ipe-r1/

Hi,I've done a quick test for read-only SD configurations, this will work, maybe we need some tuning on some directories according the licensing... need some more time to do this in detail and write a how to then.BREdwin

Hello all,this might really a good possibility to make it more 'robust'... -> to be provedIn my case I use the following procedure including licensing the pi. (sure this is optional)1. start point is: Image from store or from raspberrypi.org and the installed codesys debian package2. Optional: install the license3. In my case I use a USB-Key which is read/writeable, where later the plc boot application and all needed files which CODESYS create are stored ( visu files /trend files license) etc4. mount the USB-Key (sudo mount -t vfat -o uid=pi,gid=pi /dev/sda1 /media/) to /media and copy the content of /root to /media (this include the license to if the Pi is licensed)5. change the runtime application directory to /mediasudo nano /etc/init.d/codesyscontrolsee screenshotand change the location of PlcConfigFile        export PlcConfigFile=/media/CODESYSControl.cfgand cd /media/save the changed codesyscontrol6.add/change to /etc/CODESYSControl.cfg [SysFile]FilePath.1=/etc/, 3S.datFilePath.2=/media/, *.app, *.crcmove CODESYSControl.cfg and 3S.dat to your new location - in my case /media/7. from that link: http://blog.pi3g.com/2014/04/make-raspb ... read-only/Step by step how from the link above slightly changed to have an addition USB Stick for application data, licenseDisable swapdphys-swapfile swapoffdphys-swapfile uninstallupdate-rc.d dphys-swapfile disableInstall UnionFSaptitude install unionfs-fuseCreate mount scriptnano /usr/local/bin/mount_unionfs#!/bin/sh[ -z "$1" ] && exit 1 || DIR=$1ROOT_MOUNT=$(grep -v "^#" /etc/fstab | awk '$2=="/" {print substr($4,1,2)}')if [ "$ROOT_MOUNT" != "ro" ]; then  /bin/mount --bind ${DIR}_org ${DIR}else  /bin/mount -t tmpfs ramdisk ${DIR}_rw  /usr/bin/unionfs-fuse -o cow,allow_other,suid,dev,nonempty ${DIR}_rw=RW:${DIR}_org=RO ${DIR}fimake it executable:chmod +x /usr/local/bin/mount_unionfsnano /etc/fstab(D01F-8E5A is what you need to adapt to your stick - you get this ID by sudo blkid /dev/sdb1 or sudo blkid /dev/sda1)cat /etc_org/fstabCode:proc            /proc           proc    defaults          0       0/dev/mmcblk0p1  /boot           vfat    ro                0       2/dev/mmcblk0p2  /               ext4    ro,noatime        0       1mount_unionfs   /etc            fuse    defaults          0       0mount_unionfs   /var            fuse    defaults          0       0none            /tmp            tmpfs   defaults          0       0UUID=[b]D01F-8E5A[/b] /media/ vfat defaults,auto,umask=000,users,rw 0Prepare the directoriescp -al /etc /etc_orgmv /var /var_orgmkdir /etc_rwmkdir /var /var_rwrebootcheck if everything is readonly by mount you get:/dev/root on / type ext4 (ro,noatime,data=ordered)devtmpfs on /dev type devtmpfs (rw,relatime,size=219764k,nr_inodes=54941,mode=755)tmpfs on /run type tmpfs (rw,nosuid,noexec,relatime,size=44788k,mode=755)tmpfs on /run/lock type tmpfs (rw,nosuid,nodev,noexec,relatime,size=5120k)proc on /proc type proc (rw,nosuid,nodev,noexec,relatime)sysfs on /sys type sysfs (rw,nosuid,nodev,noexec,relatime)tmpfs on /run/shm type tmpfs (rw,nosuid,nodev,noexec,relatime,size=89560k)devpts on /dev/pts type devpts (rw,nosuid,noexec,relatime,gid=5,mode=620,ptmxmode=000)/dev/mmcblk0p1 on /boot type vfat (ro,relatime,fmask=0022,dmask=0022,codepage=437,iocharset=ascii,shortname=mixed,errors=remount-ro)ramdisk on /etc_rw type tmpfs (rw,relatime)unionfs-fuse on /etc type fuse.unionfs-fuse (rw,relatime,user_id=0,group_id=0,default_permissions,allow_other)fusectl on /sys/fs/fuse/connections type fusectl (rw,relatime)ramdisk on /var_rw type tmpfs (rw,relatime)unionfs-fuse on /var type fuse.unionfs-fuse (rw,relatime,user_id=0,group_id=0,default_permissions,allow_other)none on /tmp type tmpfs (rw,relatime)/dev/sdb1 on /media type vfat (rw,nosuid,nodev,noexec,relatime,fmask=0000,dmask=0000,allow_utime=0022,codepage=437,iocharset=ascii,shortname=mixed,errors=remount-ro)Connect with CODESYS Developmentsystem - download Webvisu example and check 1. if license is ok2. all applications files are redirected to /media (Usb stick)you should see Application.app, Application.crc visu directory etc on the USB Stick /mediaLet me know if this work for you.If anyone find the time a long term test like for example 1000 times switch on and randomly switch off the pi should prove if this is a realrobust solution for have a large SD card life cycle.BREdwin

Hi.I try your method with some difference to use a third partition on sd card but after reboot of application download i take the message "Application 'Application' does not exist on device 'Device'. Do you want to create it and proceed with download?".Did you check your method?I found that need more changes in "sudo nano /etc/init.d/codesyscontrol" because we have licence errors at boot.Any help?

Hi,you need to add your new location / redirection path  to the CODESYSControl.cfgin my case this was:FilePath.2=/media/, *.app, *.crcI've added this to the description above.Not sure if a redirection to an separate partition on the same SD Card will prevent the SD card corruption.BREdwin

Hi.I made the changes in CODESYSControl.cfg.Sorry it doesn't works after rebbot.All look ok, the application exist in new folder but not running and the CodesysV3 not finding with refresh list of applications.Any idea?

Hi,sure missing in CODESYSControl.cfgthe FilePath.1 to set on your new location, because here  CDS store the name of the Bootproject to load.[SysFile]FilePath.1=/media/, 3S.datFilePath.2=/media/, *.app, *.crcadditional you need to change the path in the config file in /etc/init.d/codesyscontrol  export PlcConfigFile=/media/CODESYSControl.cfgBREdwin

Nothing has changed.

This should work on your SD too. copy CODESYSControl.cfg and 3S.dat to the new location of your redirected pathIf you are already readonly with your system, are you sure you have changed CODESYSControl.cfg in /etc_org/ ?This was in my case the mistake.so remount to rw and change /etc_org/CODESYSControl.cfg and /etc_org/init.d/codesyscontrol these two path changes-> reboot

HiWith copy of CODESYS Control.cfg and 3S.dat it works.Now i try the same with usb device.Do you think it needs all of them changes?Regards

Hi,change the path settings in /etc/init.d/codesycontrolthen move the files of /root to /media and move /etc/CODESYSControl.cfg and move /etc/3S.dat to /mediaAfter this works -> the make it RO part should follow.RegardsEdwin

Hi.I'm newbe in Linux but I tthink after many many tests that problemsbegins from permissions of folders type "/etc" ,"/var" and "/media".Finally I get it run and from third partition of sd card and from usb storage.Regards*The watchdog works ok.

I see green led of Raspberry Pi B+ flashes ( little flash ) continuously 1 time per second.Is this normal?Is this bad for sd card?

Hi,would propose to install:apt-get install nmonor iotopthen check if there is any write activity.BREdwin

Nmon don't show any activity at Disk I/O.Only my Raspberry do this flashing?

Some times after reboots from watchdog i lose the webvisu connection and codesys visualization.Any idea?

Hi,please check the plc log for more information.BREdwin

Do you mean "codesyscontrol.log" from "tmp" folder?I can't understand it.Code:Linux version 3.12.22+ (dc4@dc4-arm-01) (gcc version 4.7.2 20120731 (prerelease) (crosstool-NG linaro-1.13.1+bzr2458 - Linaro GCC 2012.08) ) #691 PREEMPT Wed Jun 18 18:29:58 BST 2014********* CoDeSysControl DEMO VERSION - runs 2 hours*********machine: armv6ltimer resolution: 1nsec=======================================================================1412029351: Cmp=CM, Class=1, Error=0, Info=4, pszInfo= CODESYS Control V31412029351: Cmp=CM, Class=1, Error=0, Info=5, pszInfo= Copyright (c) 3S - Smart Software Solutions GmbH1412029351: Cmp=CM, Class=1, Error=0, Info=6, pszInfo= <version>3.5.5.0</version> <builddate>Jul 31 2014</builddate>=======================================================================1412029351: Cmp=CM, Class=1, Error=0, Info=7, pszInfo= System: <cmp>CM</cmp> init, <id>0x00000001</id> <ver>3.5.5.0</ver>1412029351: Cmp=CM, Class=1, Error=0, Info=7, pszInfo= System: <cmp>CmpMemPool</cmp> init, <id>0x0000001e</id> <ver>3.5.5.0</ver>1412029351: Cmp=CM, Class=1, Error=0, Info=7, pszInfo= System: <cmp>CmpLog</cmp> init, <id>0x00000013</id> <ver>3.5.5.0</ver>1412029351: Cmp=CM, Class=1, Error=0, Info=7, pszInfo= System: <cmp>CmpSettings</cmp> init, <id>0x0000001a</id> <ver>3.5.5.0</ver>1412029351: Cmp=CM, Class=1, Error=0, Info=7, pszInfo= System: <cmp>SysFile</cmp> init, <id>0x00000104</id> <ver>3.5.5.0</ver>1412029351: Cmp=CM, Class=1, Error=0, Info=7, pszInfo= System: <cmp>SysCpuHandling</cmp> init, <id>0x00000101</id> <ver>3.5.5.0</ver>1412029351: Cmp=CM, Class=1, Error=0, Info=7, pszInfo= System: <cmp>SysOut</cmp> init, <id>0x0000010b</id> <ver>3.5.5.0</ver>1412029351: Cmp=CM, Class=1, Error=0, Info=7, pszInfo= System: <cmp>SysModule</cmp> init, <id>0x00000109</id> <ver>3.5.5.0</ver>1412029351: Cmp=CM, Class=1, Error=0, Info=7, pszInfo= System: <cmp>SysCom</cmp> init, <id>0x00000100</id> <ver>3.5.5.0</ver>1412029351: Cmp=CM, Class=1, Error=0, Info=7, pszInfo= System: <cmp>SysDir</cmp> init, <id>0x0000011b</id> <ver>3.5.5.0</ver>1412029351: Cmp=CM, Class=1, Error=0, Info=7, pszInfo= System: <cmp>SysEvent</cmp> init, <id>0x00000102</id> <ver>3.5.5.0</ver>1412029351: Cmp=CM, Class=1, Error=0, Info=7, pszInfo= System: <cmp>_</cmp> init, <id>0x00000103</id> <ver>3.5.5.0</ver>1412029351: Cmp=CM, Class=1, Error=0, Info=7, pszInfo= System: <cmp>SysInternalLib</cmp> init, <id>0x00000107</id> <ver>3.5.5.0</ver>1412029351: Cmp=CM, Class=1, Error=0, Info=7, pszInfo= System: <cmp>SysMem</cmp> init, <id>0x00000108</id> <ver>3.5.5.0</ver>1412029351: Cmp=CM, Class=1, Error=0, Info=7, pszInfo= System: <cmp>SysSem</cmp> init, <id>0x0000010f</id> <ver>3.5.5.0</ver>1412029351: Cmp=CM, Class=1, Error=0, Info=7, pszInfo= System: <cmp>SysSocket</cmp> init, <id>0x00000111</id> <ver>3.5.5.0</ver>1412029351: Cmp=CM, Class=1, Error=0, Info=7, pszInfo= System: <cmp>SysTarget</cmp> init, <id>0x00000112</id> <ver>3.5.5.0</ver>1412029351: Cmp=CM, Class=1, Error=0, Info=7, pszInfo= System: <cmp>SysTask</cmp> init, <id>0x00000114</id> <ver>3.5.5.0</ver>1412029351: Cmp=CM, Class=1, Error=0, Info=7, pszInfo= System: <cmp>SysTime</cmp> init, <id>0x00000115</id> <ver>3.5.5.0</ver>1412029351: Cmp=CM, Class=1, Error=0, Info=7, pszInfo= System: <cmp>SysTimeRtc</cmp> init, <id>0x00000127</id> <ver>3.5.5.0</ver>1412029351: Cmp=CM, Class=1, Error=0, Info=7, pszInfo= System: <cmp>SysTimer</cmp> init, <id>0x00000116</id> <ver>3.5.5.0</ver>1412029351: Cmp=CM, Class=1, Error=0, Info=7, pszInfo= System: <cmp>SysFileStream</cmp> init, <id>0x00000120</id> <ver>3.5.5.0</ver>1412029351: Cmp=CM, Class=1, Error=0, Info=7, pszInfo= System: <cmp>SysShm</cmp> init, <id>0x00000110</id> <ver>3.5.5.0</ver>1412029351: Cmp=CM, Class=1, Error=0, Info=7, pszInfo= System: <cmp>SysMsgQ</cmp> init, <id>0x0000010a</id> <ver>3.5.5.0</ver>1412029351: Cmp=CM, Class=1, Error=0, Info=7, pszInfo= System: <cmp>SysSemProcess</cmp> init, <id>0x00000119</id> <ver>3.5.5.0</ver>1412029351: Cmp=CM, Class=1, Error=0, Info=7, pszInfo= System: <cmp>SysEthernet</cmp> init, <id>0x0000011c</id> <ver>3.5.5.0</ver>1412029351: Cmp=CM, Class=1, Error=0, Info=7, pszInfo= System: <cmp>SysProcess</cmp> init, <id>0x0000010e</id> <ver>3.5.5.0</ver>1412029351: Cmp=CM, Class=1, Error=0, Info=7, pszInfo= <cmp>CmpApp</cmp> init, <id>0x00000002</id> <ver>3.5.5.0</ver>1412029351: Cmp=CM, Class=1, Error=0, Info=7, pszInfo= <cmp>CmpAppBP</cmp> init, <id>0x00000073</id> <ver>3.5.5.0</ver>1412029351: Cmp=CM, Class=1, Error=0, Info=7, pszInfo= <cmp>CmpAppForce</cmp> init, <id>0x00000074</id> <ver>3.5.5.0</ver>1412029351: Cmp=CM, Class=1, Error=0, Info=7, pszInfo= <cmp>CmpAsyncMgr</cmp> init, <id>0x0000005f</id> <ver>3.5.5.0</ver>1412029351: Cmp=CM, Class=1, Error=0, Info=7, pszInfo= <cmp>CmpChecksum</cmp> init, <id>0x0000000b</id> <ver>3.5.5.0</ver>1412029351: Cmp=CM, Class=1, Error=0, Info=7, pszInfo= <cmp>CmpDevice</cmp> init, <id>0x0000000e</id> <ver>3.5.5.0</ver>1412029351: Cmp=CM, Class=1, Error=0, Info=7, pszInfo= <cmp>CmpEventMgr</cmp> init, <id>0x0000005b</id> <ver>3.5.5.0</ver>1412029351: Cmp=CM, Class=1, Error=0, Info=7, pszInfo= <cmp>CmpFileTransfer</cmp> init, <id>0x0000005e</id> <ver>3.5.5.0</ver>1412029351: Cmp=CM, Class=1, Error=0, Info=7, pszInfo= <cmp>CmpIecStringUtils</cmp> init, <id>0x0000007f</id> <ver>3.5.5.0</ver>1412029351: Cmp=CM, Class=1, Error=0, Info=7, pszInfo= <cmp>CmpIecTask</cmp> init, <id>0x00000011</id> <ver>3.5.5.0</ver>1412029351: Cmp=CM, Class=1, Error=0, Info=7, pszInfo= <cmp>CmpMonitor</cmp> init, <id>0x00000014</id> <ver>3.5.5.0</ver>1412029351: Cmp=CM, Class=1, Error=0, Info=7, pszInfo= <cmp>CmpMonitor2</cmp> init, <id>0x00000032</id> <ver>3.5.5.0</ver>1412029351: Cmp=CM, Class=1, Error=0, Info=7, pszInfo= <cmp>CmpIoDrvC</cmp> init, <id>0x00000066</id> <ver>3.5.5.0</ver>1412029351: Cmp=CM, Class=1, Error=0, Info=7, pszInfo= <cmp>CmpIoDrvIec</cmp> init, <id>0x0000005a</id> <ver>3.5.5.0</ver>1412029351: Cmp=CM, Class=1, Error=0, Info=7, pszInfo= <cmp>CmpIoMgr</cmp> init, <id>0x00000012</id> <ver>3.5.5.0</ver>1412029351: Cmp=CM, Class=1, Error=0, Info=7, pszInfo= <cmp>CmpRetain</cmp> init, <id>0x00000017</id> <ver>3.5.5.0</ver>1412029351: Cmp=CM, Class=1, Error=0, Info=7, pszInfo= <cmp>CmpRouter</cmp> init, <id>0x00000018</id> <ver>3.5.5.0</ver>1412029351: Cmp=CM, Class=1, Error=0, Info=7, pszInfo= <cmp>CmpSchedule</cmp> init, <id>0x00000019</id> <ver>3.5.5.0</ver>1412029351: Cmp=CM, Class=1, Error=0, Info=7, pszInfo= <cmp>CmpSrv</cmp> init, <id>0x0000001c</id> <ver>3.5.5.0</ver>1412029351: Cmp=CM, Class=1, Error=0, Info=7, pszInfo= <cmp>CmpBlkDrvTcp</cmp> init, <id>0x00000030</id> <ver>3.5.5.0</ver>1412029351: Cmp=CM, Class=1, Error=0, Info=7, pszInfo= <cmp>CmpBlkDrvUdp</cmp> init, <id>0x00000007</id> <ver>3.5.5.0</ver>1412029351: Cmp=CM, Class=1, Error=0, Info=7, pszInfo= <cmp>CmpBinTagUtil</cmp> init, <id>0x00000004</id> <ver>3.5.5.0</ver>1412029351: Cmp=CM, Class=1, Error=0, Info=7, pszInfo= <cmp>CmpChannelMgr</cmp> init, <id>0x00000009</id> <ver>3.5.5.0</ver>1412029351: Cmp=CM, Class=1, Error=0, Info=7, pszInfo= <cmp>CmpChannelServer</cmp> init, <id>0x0000000a</id> <ver>3.5.5.0</ver>1412029351: Cmp=CM, Class=1, Error=0, Info=7, pszInfo= <cmp>CmpNameServiceServer</cmp> init, <id>0x00000016</id> <ver>3.5.5.0</ver>1412029351: Cmp=CM, Class=1, Error=0, Info=7, pszInfo= <cmp>CmpCommunicationLib</cmp> init, <id>0x0000000c</id> <ver>3.5.5.0</ver>1412029351: Cmp=CM, Class=1, Error=0, Info=7, pszInfo= <cmp>CmpCoreDump</cmp> init, <id>0x00000083</id> <ver>3.5.5.0</ver>1412029351: Cmp=CM, Class=1, Error=0, Info=7, pszInfo= <cmp>CmpIecVarAccess</cmp> init, <id>0x00000060</id> <ver>3.5.5.0</ver>1412029351: Cmp=CM, Class=1, Error=0, Info=7, pszInfo= <cmp>CmpPlcShell</cmp> init, <id>0x00000128</id> <ver>3.5.5.0</ver>1412029351: Cmp=CM, Class=1, Error=0, Info=7, pszInfo= <cmp>CmpTraceMgr</cmp> init, <id>0x00000070</id> <ver>3.5.5.0</ver>1412029351: Cmp=CM, Class=1, Error=0, Info=7, pszInfo= <cmp>CmpNameServiceClient</cmp> init, <id>0x00000015</id> <ver>3.5.5.0</ver>1412029351: Cmp=CM, Class=1, Error=0, Info=7, pszInfo= <cmp>CmpChannelClient</cmp> init, <id>0x00000008</id> <ver>3.5.5.0</ver>1412029351: Cmp=CM, Class=1, Error=0, Info=7, pszInfo= <cmp>CmpCAAAsyncMan</cmp> init, <id>0x00004007</id> <ver>3.5.5.0</ver>1412029351: Cmp=CM, Class=1, Error=0, Info=7, pszInfo= <cmp>CmpCAABehaviourModel</cmp> init, <id>0x00004015</id> <ver>3.5.5.0</ver>1412029351: Cmp=CM, Class=1, Error=0, Info=7, pszInfo= <cmp>CmpCAACallback</cmp> init, <id>0x00004001</id> <ver>3.5.5.0</ver>1412029351: Cmp=CM, Class=1, Error=0, Info=7, pszInfo= <cmp>CmpCAADTUtil</cmp> init, <id>0x00004013</id> <ver>3.5.5.0</ver>1412029351: Cmp=CM, Class=1, Error=0, Info=7, pszInfo= <cmp>CmpCAAFile</cmp> init, <id>0x00004008</id> <ver>3.5.5.0</ver>1412029351: Cmp=CM, Class=1, Error=0, Info=7, pszInfo= <cmp>CmpCAAMemBlockMan</cmp> init, <id>0x00004003</id> <ver>3.5.5.0</ver>1412029351: Cmp=CM, Class=1, Error=0, Info=7, pszInfo= <cmp>CmpCAANetBaseServices</cmp> init, <id>0x00004018</id> <ver>3.5.5.0</ver>1412029351: Cmp=CM, Class=1, Error=0, Info=7, pszInfo= <cmp>CmpCAARealTimeClock</cmp> init, <id>0x00004014</id> <ver>3.5.5.0</ver>1412029351: Cmp=CM, Class=1, Error=0, Info=7, pszInfo= <cmp>CmpCAASegBufferMan</cmp> init, <id>0x00004019</id> <ver>3.5.5.0</ver>1412029351: Cmp=CM, Class=1, Error=0, Info=7, pszInfo= <cmp>CmpCAASerialCom</cmp> init, <id>0x00004012</id> <ver>3.5.5.0</ver>1412029351: Cmp=CM, Class=1, Error=0, Info=7, pszInfo= <cmp>CmpCAATick</cmp> init, <id>0x00004009</id> <ver>3.5.5.0</ver>1412029351: Cmp=CM, Class=1, Error=0, Info=7, pszInfo= <cmp>CmpCAATickUtil</cmp> init, <id>0x00004010</id> <ver>3.5.5.0</ver>1412029351: Cmp=CM, Class=1, Error=0, Info=7, pszInfo= <cmp>CmpCAATypes</cmp> init, <id>0x00004006</id> <ver>3.5.5.0</ver>1412029351: Cmp=CM, Class=1, Error=0, Info=7, pszInfo= <cmp>CmpChannelClientIec</cmp> init, <id>0x0000005d</id> <ver>3.5.5.0</ver>1412029351: Cmp=CM, Class=1, Error=0, Info=7, pszInfo= <cmp>CmpNameServiceClientIec</cmp> init, <id>0x0000011d</id> <ver>3.5.5.0</ver>1412029351: Cmp=CM, Class=1, Error=0, Info=7, pszInfo= <cmp>CmpBinTagUtilIec</cmp> init, <id>0x0000005c</id> <ver>3.5.5.0</ver>1412029351: Cmp=CM, Class=1, Error=0, Info=7, pszInfo= <cmp>CmpUserDB</cmp> init, <id>0x00000064</id> <ver>3.5.5.0</ver>1412029351: Cmp=CM, Class=1, Error=0, Info=7, pszInfo= <cmp>CmpUserMgr</cmp> init, <id>0x00000061</id> <ver>3.5.5.0</ver>1412029351: Cmp=CM, Class=1, Error=0, Info=7, pszInfo= <cmp>CmpCryptMD5</cmp> init, <id>0x0000006a</id> <ver>3.5.5.0</ver>1412029351: Cmp=CM, Class=1, Error=0, Info=7, pszInfo= <cmp>CmpCharDevice</cmp> init, <id>0x00000300</id> <ver>3.5.5.0</ver>1412029351: Cmp=CM, Class=1, Error=0, Info=7, pszInfo= <cmp>CmpRasPi</cmp> init, <id>0x00002345</id> <ver>3.5.4.0</ver>1412029351: Cmp=CM, Class=1, Error=0, Info=7, pszInfo= <cmp>CmpBitmapPool</cmp> init, <id>0x00000050</id> <ver>3.5.5.0</ver>1412029351: Cmp=CM, Class=1, Error=0, Info=7, pszInfo= <cmp>CmpDynamicText</cmp> init, <id>0x00000051</id> <ver>3.5.5.0</ver>1412029351: Cmp=CM, Class=1, Error=0, Info=7, pszInfo= <cmp>CmpVisuHandler</cmp> init, <id>0x00000054</id> <ver>3.5.5.0</ver>1412029351: Cmp=CM, Class=1, Error=0, Info=7, pszInfo= <cmp>CmpVisuServer</cmp> init, <id>0x00000057</id> <ver>3.5.5.0</ver>1412029351: Cmp=CM, Class=1, Error=0, Info=7, pszInfo= <cmp>CmpWebServer</cmp> init, <id>0x00000071</id> <ver>3.5.5.0</ver>1412029351: Cmp=CM, Class=1, Error=0, Info=7, pszInfo= <cmp>CmpWebServerHandlerV3</cmp> init, <id>0x00000072</id> <ver>3.5.5.0</ver>1412029351: Cmp=CM, Class=1, Error=0, Info=7, pszInfo= <cmp>CmpCAAStorage</cmp> init, <id>0x0000007e</id> <ver>3.5.5.0</ver>1412029351: Cmp=CM, Class=1, Error=0, Info=7, pszInfo= <cmp>CmpAlarmManager</cmp> init, <id>0x0000007c</id> <ver>3.5.5.0</ver>1412029351: Cmp=CM, Class=1, Error=0, Info=7, pszInfo= <cmp>CmpGateway</cmp> init, <id>0x0000000f</id> <ver>3.5.5.0</ver>1412029351: Cmp=CM, Class=1, Error=0, Info=7, pszInfo= <cmp>CmpGwCommDrvTcp</cmp> init, <id>0x00000010</id> <ver>3.5.5.0</ver>1412029351: Cmp=CM, Class=1, Error=0, Info=7, pszInfo= <cmp>CmpCodeMeter</cmp> init, <id>0x0000007a</id> <ver>3.5.5.0</ver>1412029351: Cmp=CM, Class=1, Error=0, Info=7, pszInfo= Dynamic: <cmp>CmpOpenSSL</cmp> init, <id>0x00000033</id> <ver>3.5.5.0</ver>1412029354: Cmp=CmpBlkDrvUdp, Class=1, Error=0, Info=6, pszInfo= Network interface: <ipaddress>192.168.1.123</ipaddress>, subnetmask <su

Hi,please access the webvisu in your browser and then give me a screenshot of the logger in codesys (if you do at in /tmp/codesyscontol.log - this is only flushed from time to time)BREdwin

Log.

hi,seems to work from logger messages... is that the case where you do not have a connection in the browser?The error case screenshot is needed.BREdwin

No.I try to send a new log when the problem exists.Regards

Hi Edwin.1000 watchdog reboots in 12 hours with sd card read only and usb drive as run time host without problem!Regards.

Hi,very good, seems to work reliable.BREdwin

hi I have been breaking the sd card several times, the solution seems very good, doing this, we would already be enabled Retain variables ?. Could someone put an image with condiguracion sd read only? Thank you. Greetings.

Hi,I have several problems when the app is running for long time:After two hours:           -I haven't trend. I tried to change the directory and configuration, always the same error.Attachment:after 2 hours.PNGAttachment:config.PNGAttachment:aconfig.PNGAttachment:codesys.PNGAfter four hours:         - It can´t  write log in Pendrive or SD. Error= NO_EXIST but i can see the directory and files with VNC. My personal log was running by 4h no more.Attachment:write error.PNG         - I haven't IPv4 and I can't access to Webvisu form Browser.Attachment:Ip.PNG         - I add a screenshot of the log.Attachment:log.PNGThank you very much to everyone for your help.PD. The license was check and ok (yellow light)BRHector.

Just put my raspy in read only mode. Instead of a usb drive i created a 3rd partition and followed the instructions of Mr. Schwellinger.Unfortunally i get a licence error for the Profinet Interface (Screenshots after Download, not started!)Can somebody help me pls...Regards.

still searching in /etc/CODESYSControl.cfg (see screenshot), although i modified the /etc/init.d/codesyscontrol:Code:do_start () {        make_mknod        export PlcConfigFile=/media/CODESYSControl.cfg        if [ -d "/sys/bus/platform/drivers/bcm2708_i2c/" ]; then                echo bcm2708_i2c.0 > /sys/bus/platform/drivers/bcm2708_i2c/unbind                echo 400000 > /sys/module/i2c_bcm2708/parameters/baudrate                echo bcm2708_i2c.0 > /sys/bus/platform/drivers/bcm2708_i2c/bind        fi        # 1 wire        modprobe w1-gpio pullup=1        modprobe w1-therm        cd /media/        # Return        #   0 if daemon has been started        #   1 if daemon was already running        #   2 if daemon could not be started        start-stop-daemon --start --quiet --pidfile $PIDFILE --exec $DAEMON --test --chdir $WORKDIR > /dev/null || return 1        start-stop-daemon --start --background --make-pidfile --pidfile $PIDFILE --chdir $WORKDIR --startas /bin/bash  -- -c "exec $DAEMON -d $CONFIGFILE >$LOGFILE 2>&1 " || return 2        # pin codesys to first cpu!        /usr/bin/taskset -a -p 01 $(cat $PIDFILE);        sleep 1 && pgrep codesyscontrol > /dev/null && echo "codesyscontrol started" || echo "ERROR: codesyscontrol not started!";}

Hi,which readonly system do you use?a nice approach would be this one (based on strech lite):https://www.raspberrypi.org/blog/adafruits-read-only/BREdwin

Hello Mr. Schwellinger,I used the raspian strecht lite (https://downloads.raspberrypi.org/raspbian_lite_latest). After first boot, i used fdisk to resize root partition to 4gig. Then i created a 3rd partition with the remaining memory (i use a 8gig SD) and folled every step mentioned by your previous post...Can you explain the first error of my last screen: "cannot find configuration /etc/CODESYSControl.cfg"? Why CODESYS still searching in this directory instead of /media/CODESYSControl.cfg?Regards,adv

Hi,I'm using it that way(this is a bit tricky, guess there are many better solutions for doing it):Install Stretch lite on the SD Card.Executeread-only-fs.shI use this jumper on GPIO Pins to select on bootup if the whole SD is monted readonly or not.- set to rw - insall the CODESYS Runtime via Update Tool-license the CODESYS Pi runtimethen execute the following script once:read-only-CDS_after_licenseing.sh#!/bin/bash# Use this script to setup the licenses once in RW mode after activateing the licensemkdir /home/pi/cmact_licensescp /var/opt/codesys/cmact_licenses/* /tmp/cmact_licenses/cp /var/opt/codesys/cmact_licenses/* /home/pi/cmact_licenses/rm /var/opt/codesys/cmact_licenses/*rmdir /var/opt/codesys/cmact_licensessudo ln -sf /tmp/cmact_licenses/ /var/opt/codesys/cmact_licensesThen add to /etc/init.d/codesyscontrol just before the runtim start[b]read-only-CDS.sh[/b]#!/bin/bash# CDS Extension make it work this need to be called before CDS runtime startsmkdir /tmp/cmact_licensescp /home/pi/cmact_licenses/* /tmp/cmact_licensesThis procedure copy the license to rw ram - which is needed to have it up an working.BREdwinSure you could only copy new applications to the readonly Pi if you set this Jumper on the GPIO's to have it in RW mode.BREdwin

Ok... but that's just another solution for read only raspy and don't solve my specific problem.Can you just explain, why CODESYS searching in  /etc/CODESYSControl.cfg although i modified the /etc/init.d/codesyscontrol...I think this is the problem, which has to be fixed, instead of changing the whole setup like you described in your previous post...Regards.

Hi,guess you haved missed to change it here:BREdwin

no!

Dont understand the messages (see screenshot):

Hi,you need to move the 3S.dat from /etc/ to your new runtime directory... (Location where CODESYSControl.cfg is located)BREdwin

no, already done!  EDIT:Which files are mandatory for licensing? In which directory has these files to be exist?Which files/directory has to be writable?If i go to PLC-settings (SPS-Einstellungen) to "edit license" I see the license (see screenshot):

hi,then you Need to adapt this entry here:BREdwin

no i alreade changed this like you mentioned in your previous post:Quote:6.add/change to /etc/CODESYSControl.cfg[SysFile]FilePath.1=/etc/, 3S.datFilePath.2=/media/, *.app, *.crcmove CODESYSControl.cfg and 3S.dat to your new location - in my case /media/I just change the entry to this:Quote:[SysFile]FilePath.1=/etc/FilePath.2=/media/, *.app, *.crc, 3S.datStill not working...  EDIT:Missing license is just for Profinet right?!?!?

[SysFile]FilePath.1=/media/, 3S.datFilePath.2=/media/, *.app, *.crcif you see a message in the logger 'missing license file' all fieldbus licenses/webvisu is missing.You are using 3.5SP11 runtime - right?BREdwin

yes, 3.5.11.10:Package-Info:Code:rootDesired=Unknown/Install/Remove/Purge/Hold| Status=Not/Inst/Conf-files/Unpacked/halF-conf/Half-inst/trig-aWait/Trig-pend|/ Err?=(none)/Reinst-required (Status,Err: uppercase=bad)||/ Name           Version      Architecture Description+++-==============-============-============-=========================================ii  codesyscontrol 3.5.11.10    all          V3.5.11.10, Do 10. Aug 12:28:26 CEST 2017I recognize following and maybe that is a problem. In your instruction you said:Quote:5. change the runtime application directory to /mediasudo nano /etc/init.d/codesyscontrolsee screenshotand change the location of PlcConfigFileexport PlcConfigFile=/media/CODESYSControl.cfgandcd /media/In the screenshot i put my /etc/init.d/codesyscontrol.I changed/added the yellow lines. The script is slightly diffrent then yours (see orange rectangle).And i see that WORKDIR still pointing to /var/opt/codesys which is a unionfs (/var_org and /var_rw). So writing an boot image for example will not be stored remanent on the sd card (stored to /var_rw/opt/codesys which is a ramfs)?!?!You said:Quote:...2. all applications files are redirected to /media (Usb stick)you should see Application.app, Application.crc visu directory etc on the USB Stick /media...and thats not the case. Maybe soming in the init.d script has changed which i have to pay attention on?!

Hi,you mean everything works now (your license - missing license file) is solved?I think the missing part is now:Since 3.5SP11 the /etc/CODESYSControl.cfg is splittet in an fix partCODESYSControl.cfg and Userpart CODESYSControl_User.cfg ... so if you do an download CODESYS add in CODESYSControl_User.cfgthe name of the Booproject for example.[CmpSettings]FileReference.0=SysFileMap.cfg, SysFileMapFileReference.1=/etc/CODESYSControl_User.cfgMaybe you addapt this already.'and thats not the case. Maybe soming in the init.d script has changed which i have to pay attention on?!'Could you please check if on your /media/PlcLogic Directory after downloading the application you see Application/Application.app and Application.crc?BREdwin

no, license still dont work!     Quote:Since 3.5SP11 the /etc/CODESYSControl.cfg is splittet in an fix partCODESYSControl.cfg and Userpart CODESYSControl_User.cfg ... so if you do an download CODESYS add in CODESYSControl_User.cfgthe name of the Booproject for example.1.) I changed the WORKDIR variable in the init.d script to /media/var/opt/codesys. Then i created the directorys and copied all files from /var/opt/codesys to it.2.) I copied the file /etc/CODESYSControl_User.cfg to /media/CODESYSControl_User.cfg3.) I changed the path /etc/CODESYSControl_User.cfg to /media/CODESYSControl_User.cfg in the configuration file /media/CODESYSControl.cfgAfter reboot CODESYS starts normally, but still with the licence issue. Downloading an application successfully creates the directoy /media/var/opt/codesys/PlcLogic/Application and the files "Application.app and Application.crc".As expected, in the directoy /var/opt/codesys/PlcLogic nothing is created.After 2nd reboot i can go online and the application is running!So "only" the license issue is still a problem...  

Hi,you mean only the fieldbus licenses are the problem or do you mean the plc license (2h Limitation)ist still not working?BREdwin

Only the Profinet (and OPC-UA, which i dont use).... The Raspy was running through the weekend and i just logged in without problems... These are the warning and errors from the log (screenshot):EDIT:2nd screenshot with information entries... (note the "runtime licensed" entry at line 5...)P.S.: The timestamps are not correct, because the clock of the Pi are not set correctly (no RTC, no internet connection)...

Hi,license file 3S.dat is still not accessible...did you move/copy it from /etc/ to your new runtime location?BREdwin

Yes!My new location is /media (mounted to the rw-partition):Code::/media# ls -latotal 56drwxrwxrwx  5 root root  4096 Oct 29  2017 .drwxr-xr-x 25 root root  4096 Oct 26 08:53 ..-rw-r--r--  1 root root   158 Jan 19  2017 3S.dat-rw-------  1 root root    47 Sep  7 17:06 .bash_history-rw-r--r--  1 root root   570 Sep  7 17:06 .bashrc-rw-r--r--  1 root root   760 Oct 29  2017 CODESYSControl.cfg-rw-r--r--  1 root root   242 Oct 26 08:57 CODESYSControl_User.cfgdrwx------  2 root root 16384 Sep  7 16:26 lost+founddrwxr-xr-x  2 root root  4096 Sep  7 17:06 .nanodrwxr-xr-x  3 root root  4096 Oct 26  2017 opt-rw-r--r--  1 root root   148 Sep  7 17:06 .profileI also tried both CODESYSControl.cfg:Code::/media# cat CODESYSControl.cfg[SysFile]FilePath.1=/etc/, 3S.datFilePath.2=/media/, *.app, *.crcPlcLogicPrefix=1...andCode::/media# cat CODESYSControl.cfg[SysFile]FilePath.1=/etc/,FilePath.2=/media/, *.app, *.crc, 3S.datPlcLogicPrefix=1...License dont work either... 

Hi,this should work if the 3S.dat is in /etc[SysFile]FilePath.1=/etc/, 3S.datFilePath.2=/media/, *.app, *.crcPlcLogicPrefix=1BREdwin

Finally it woks! Thank you!But then your instructions are wrong Mr. Schwelliger?!You wrote: Quote:6.add/change to /etc/CODESYSControl.cfg[SysFile]FilePath.1=/etc/, 3S.datFilePath.2=/media/, *.app, *.crcmove CODESYSControl.cfg and 3S.dat to your new location - in my case /media/I moved that files! Thats the reason because 3S.dat was not in /etc/ anymore...Also i did not understand why changing the CODESYSControl.cfg (see below) not worked?!Code::/media# cat CODESYSControl.cfg[SysFile]FilePath.1=/etc/,FilePath.2=/media/, *.app, *.crc, 3S.datPlcLogicPrefix=1Anyhow, thank you for your support!Regards,adv

