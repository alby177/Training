Helloi tried several ways to read a word from an i2c device without the need of any (complex) devicedesc.xml and device.libraryI want to read the cap and voltage of a UPS HAT (http://www.raspberrypiwiki.com/images/6/6f/How-to-use-via-i2c.pdf)i can read the word from the device with i2cget from terminalCode:i2cget -f -y 1 0x36 4 w0x7c4dIs there a way to read those 2 bytes or this word from within a FB?I tried something like https://forum.codesys.com/viewtopic.php?f=23&t=6247&p=19944#p19944 but did not succeed.Any help will be appreciated.Thanks in advance

Hi,for I2C guess this example here would do the job:viewtopic.php?f=23&t=6247&p=19944#p19944for SPI:"c:\Users\<YourWindowsUserName>\CODESYS Control for Raspberry PI\3.5.12.0\Examples\PiFace_FB.project" BREdwin

Hi EdwinThank you for the fast answer.That was the example i already tried. But i found another one...https://forum-raspberrypi.de/forum/thread/32601-neubau-hardware/?postID=304583#post304583This example was the missing point.i need to write to the register before i read it back...just in case someone else is fighting with the basics of i2c here is my working code:Code:FUNCTION_BLOCK UPSHATVAR_INPUT   usiAddress : USINT := 16#36;END_VARVAR_OUTPUT   rVoltage : REAL := 0;END_VARVAR   // Registers   byRegVoltage    : BYTE := 16#02;   baReadBufferV : ARRAY [0..1] OF BYTE  := [2(0)];   nReadLenght: DINT;END_VAR// Register Spannung auf Bus schreiben...I2C_master.write(usiAddress, ADR(byRegVoltage), 1);  // ... und Wert lesen.nReadLenght := I2C_master.read(usiAddress, ADR(baReadBufferV), 2);// wenn zwei Bytes gelesen worden sind die Spannung berechnen uns ausgebenIF nReadLenght = 2 THEN// Daten zwischenspeichern//swap_word := MEM.PackBytesToWord(baReadBuffer[1],baReadBuffer[0]);//rVoltage := (swap_word * 78.125 / 1000000);rVoltage := (MEM.PackBytesToWord(baReadBufferV[1],baReadBufferV[0]) * 78.125 / 1000000);END_IF;

Hi,thanks for the feedback, if you want you could publish your application here:Raspberry Pi: List of available example applications think other user would be very thankful for these kind of Information and applications.BREdwin

