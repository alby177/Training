Helo!!!My Name is Andrei, and im from Russia. Sorry, for my English!I have the problem, I wanna to connect 1-wire devices to my Raspberry Pi. Now I connect to my Rpi device DB18S20 (Temperature Sensor). Drivers for this device was in my codesys package. So I wanna connect to my raspberry some devices: DS2406 (Inputs-Outputs), DS2450 (Analog outputs), DS2890 (Analog inputs). There can I find drivers for this devices? Maybe I can do it?How?Thanks for you answers!!!

Hi Andrei...You need change 1) first check that device is finding in linux 1wire driver from ssh console..2) change device xml file from archive for device description3) make new lib from Onewire_DS18B20 and change function AfterReadInput, Evaluate.. to get data from steam linux device and provide to Codesys and vice versa.

ОК, Murdemon, I change device XML for device DS2406 (Device name, ID), but i don't understand how i can make new lib from Onewire_DS18B20?I put XML file into project Onewire_DS18B20,  but i don't understand how i can change function AfterReadInput, Evaluate.. in this file? Murdemon, Thank you so much for you help!!!

Horocho... add me in skype: ladimko... you allready check 1-wire device in linux console.. it is create device for new IC connected to 1-wile line..?

Hi guys...I`m also looking for DS2438...can you share your success ?Thanks a lot

acter wrote:Hi guys...I`m also looking for DS2438...can you share your success ?Thanks a lotOk i will contact with you. Send me your email to: dmitriy.murashov@automation-engineering.ru

Does anybody know how to create new Device Description, for example from D18B20 to DS2438 ???

Hi acter,use DS18B20.devdesc.xml and rename it to your DS2438 and generate a libary called I have added both files the original and the new one.Last step is to change the library in the methode 'evaluate'Code:IF _pMaster <> 0 THEN   sPath := DataPath;   hFile := SysFileOpen(sPath, ACCESS_MODE.AM_READ, ADR(result));   IF hFile <> RTS_INVALID_HANDLE THEN      fr(hFile := hFile);      IF fr.GetLine(ADR(sData), SIZEOF(sData)) AND LEN(sData) > 3 THEN         IF RIGHT(sData, 3) = 'YES' THEN            xSignalOk := TRUE;         ELSE            xSignalOk := FALSE;         END_IF      ELSE         xSignalOk := FALSE;      END_IF      IF xSignalOk THEN         IF fr.GetLine(ADR(sData), SIZEOF(sData)) THEN            i := FIND(sData, 't=');            IF i > 0 THEN               sData := RIGHT(sData, LEN(sData) - i - 1);               IF sData = '85000' THEN                  xSignalOk := FALSE;               ELSE                  rTemp := STRING_TO_REAL(sData) * 1E-3;                  SysTimeRtcConvertUtcToDate(SysTimeRtcGet(result), stdTimeStamp);               END_IF            ELSE               xSignalOk := FALSE;            END_IF         END_IF      END_IF   ELSE      xSignalOk := FALSE;   END_IF   SysFileClose(hFile);END_IFAttention: without implementing/adapting the 'evaluate' in this new OneWire_DS2438.library to your DS2438 sensor it will not work this is the missing step to do!If you need the information how to work with libraries, read the following faq section:viewtopic.php?f=22&t=5641&p=10677#p10677You and sure you need to install the new device description to the device repository.After doing this you could add your new Onewire device, see screenshot.If it works then you please publish the library and devdesc here for other users?viewforum.php?f=23BREdwin

@Erwin: thanks a lot for the "manual", normally I`m Siemens PLC programmer, I`m learning....I try it and if I have a success, of course, I share it...Go for it !!!

at begin I found one problem...if I understand Evaluate fcn, it`s reading file in /sys/bus/w1/28-xxxxxxxxxxxxxx...but I see a directory of new sensor, but inside there are different files, than in DS18B20 directories...I Googling...and there is no support for DS2438 in RasPi kernel...Any idea ?

Hi,maybe the following links helps:http://www.raspberrypi.org/forums/viewt ... 44&t=50755http://rants.dyer.com.hk/rpi/humidity_1w.htmlnot really sure...BREdwin

Hello Edwin,If we need write (not read) some date to our onewire device... witch method we have to overwrite?Thank you.

Hallo zusammen,bin neu hier im Forum und hänge am gleichen Problem.Ich bekomme keine gültigen Werte vom DS2438.Die lib und device-repo's von Edwin habe ich integriert.Da bekam ich allerdings zuerst einen Übersetzungsfehler. Es wurde in der device-repo noch auf den FB "OneWire_DS18B20" referenziertIch habe dann die DS2438.devdesc.xml geändert auf OneWire_DS2438, so wie der FB in der lib auch aufgerufen wird.Der Treiber läuft aber leider immer noch nicht an.Im Pfad /sys/bus/w1/drivers/w1_slave_driver/26-0000017c96bd habe ich:id, name, rw, uevent Die Datei w1_slave gibt es nicht.Hat es schon jemand geschafft einen DS2438 zu integrieren?PS: Ich bin unterwegs mit raspbian jessie

_________________Gruß Patrick

I am currently working on a driver for the DS2408 which I will publish once complete.I have written a new device descriptor and library. Both are installed and when the device is added the function block is created successfully. I am having an issue with the path to the device. Taking the driver for DS18B20 as a model, I have accessed the path to the device from the property DataPath, however when I run DataPath has the value '/sys/devices/w1_bus_master1/28-00000000000'I have set the parameter in my test application for the device to '29-000001863e6' and so expected DataPath to be  '/sys/devices/w1_bus_master1/29-000001863e6.So it appears that the OneWire function block is not reading the parameter value and is using a default. Without access to the source of OneWire I'm finding this hard to debug.The Connector part of my device descriptor is below.Code:      <Connector moduleType="500" interface="Raspberry.Onewire" role="child" explicit="false" connectorId="1" hostpath="-1">         <InterfaceName name="local:PCI">1-wire bus</InterfaceName>         <Slot count="1" allowEmpty="false">      </Slot>         <HostParameterSet>            <Parameter ParameterId="1" type="std:STRING">               <Attributes channel="none" download="true" functional="false" onlineaccess="read"/>               <Default>'XX-AABBCCDDEEFF'</Default>               <Name name="local:Id393218">Unique device address</Name>               <Description name="local:Id393218.Desc">1-wire address of the device</Description>            </Parameter>         </HostParameterSet>         <DriverInfo needsBusCycle="false">            <RequiredLib libname="Raspberry 1-wire DS2408" vendor="Cozens Software Solutions Ltd" version="0.0.0.0" identifier="IoDrvDS2408">               <FBInstance basename="$(DeviceName)" fbname="OneWire_DS2408">                  <Initialize methodName="Initialize"/>                  <CyclicCall methodname="AfterReadInputs" task="#buscycletask" whentocall="afterReadInputs"/>                  <CyclicCall methodname="BeforeWriteOutputs" task="#buscycletask" whentocall="beforeWriteOutputs"/>               </FBInstance>            </RequiredLib>         </DriverInfo>      </Connector>The function block calls Super^() in the body of the function block, BeforeWriteOutputs looks like thisCode:EvaluateOutput();SUPER^.BeforeWriteOutputs();What have I missed that is causing OneWire.DataPath to be incorrect?

A little further information if it helps. In my driver library I have temporarily ignored the value of DataPath and hard coded the value I expected. The result is that my driver is now functional, I can set output bits and read back the state. However I notice that the device status of the Onewire_master is "Not Running", I suspect that is related.

DavidCozens wrote:A little further information if it helps. In my driver library I have temporarily ignored the value of DataPath and hard coded the value I expected. The result is that my driver is now functional, I can set output bits and read back the state. However I notice that the device status of the Onewire_master is "Not Running", I suspect that is related.I'm leaving these comments here in case they help others. The issue appears to have been something to do with the history of edits. Deleting and recreating the devices it all sprang into life. I'll post drivers when they are complete.

Hi ,is there any progres with the bib for the DS2438?Thanx in advance

