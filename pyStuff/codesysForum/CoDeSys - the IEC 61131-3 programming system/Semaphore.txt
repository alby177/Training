Hi,

I need to use a semaphore to protect a global variable between several tasks. CoDeSys says that the FB SEMA is interruptable ! So if it is the case, is it reliable ?

Below a small program that would tend to prove that it is not reliable:
Code:VAR_GLOBAL  gSema: SEMA;  gVar: DWORD;END_VARCode:PROGRAM TASK1VAR  var1: DWORD;END_VARgSema(CLAIM := TRUE, RELEASE := FALSE);IF NOT gSema.BUSY THEN  var1 := var1 + 1;  gVar := gVar1 + 1;  gSema(CLAIM := FALSE, RELEASE := TRUE);END_IFCode:PROGRAM TASK2VAR  var2: DWORD;END_VARgSema(CLAIM := TRUE, RELEASE := FALSE);IF NOT gSema.BUSY THEN  var2 := var2 + 1;  gVar := gVar1 + 1;  gSema(CLAIM := FALSE, RELEASE := TRUE);END_IF
After a time, gSema.BUSY is TRUE in the two tasks !

So what real alternatives I have to protect the variable ?

Thanks for your help,
Romuald.

In fact there is a library more reliable for semaphores : SysLibSem.lib

